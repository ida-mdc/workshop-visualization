<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Converting Volumes to Meshes with VTK | 3D Data Visualization Workshop</title><link type=text/css rel=stylesheet href=https://ida-mdc.github.io/workshop-visualizationcss/theme.css><link rel=stylesheet href=/workshop-visualization/reveal/plugin/highlight/monokai.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Urbanist:wght@300;400;500;700&display=swap"><script src=/workshop-visualization/js/main.f2979a93a325fecf9605263bd141398a311c8e23388ed7dcff74f92f7e632866.js integrity="sha256-8peak6Ml/s+WBSY70UE5ijEcjiM4jtfc/3T5L35jKGY=" crossorigin=anonymous></script>
<script>function toggleMetadata(e){const t=document.getElementById("metadata-"+e),n=event.target;t.style.display==="none"||t.style.display===""?t.style.display="flex":t.style.display="none"}</script><script>document.addEventListener("DOMContentLoaded",function(){const t=new URLSearchParams(window.location.search),n=t.get("view"),e=document.getElementById("page-content");if(n==="slides"){e.classList.add("reveal"),e.classList.remove("scroll");const n=e=>{const t=document.createElement("link");t.rel="stylesheet",t.href=e,document.head.appendChild(t)},t=(e,t)=>{const n=document.createElement("script");n.src=e,n.onload=t||function(){},document.body.appendChild(n)};n("/workshop-visualization/reveal/dist/reveal.css"),n("/workshop-visualization/reveal/dist/theme/white-hi.css"),n("/workshop-visualization/reveal/plugin/highlight/monokai.css"),t("/workshop-visualization/reveal/dist/reveal.js",function(){console.log("Reveal.js loaded"),t("/workshop-visualization/reveal/plugin/markdown/markdown.js",function(){t("/workshop-visualization/reveal/plugin/highlight/highlight.js",function(){t("/workshop-visualization/reveal/plugin/notes/notes.js",function(){console.log("All Reveal.js plugins loaded and ready to initialize."),typeof Reveal!="undefined"?Reveal.initialize({hash:!0,slideNumber:!0,center:!1,disableLayout:!0,transition:"fade",display:"flex",plugins:[RevealMarkdown,RevealNotes]}):console.error("Reveal.js is not defined, initialization failed.")})})})})}else e.classList.remove("reveal"),e.classList.add("scroll")})</script><script src=/workshop-visualization/js/jquery.min.js></script>
<script type=text/javascript src=/workshop-visualization/js/jquery.qrcode.js></script>
<script type=text/javascript src=/workshop-visualization/js/qrcode.js></script></head><body><header></header><main><div class=workshop id=page-content><div class=reveal-header><a href="?view=slides" class="toggle-view hidden-in-slides">View as Slides</a><div class=hi-icon></div></div><div class="slides limited-width" id=slides-container><section style=background-image:url(/workshop-visualization/img/vtk-rendering.png)><div class=presentation-title><h1>Converting Volumes to Meshes with VTK</h1><div class=presenter><div>Deborah Schmidt</div><div>Helmholtz Imaging | MDC Berlin</div><div>Sep 25, 2024</div></div><img class=hidden-in-page src=/workshop-visualization/img/RZ_211119_Helmholtz-Imaging_Logo_4C_White.png height=90vh><aside class=notes>This tutorial will guide you through converting 3D pixel datasets, such as labelmaps and masks, into 3D meshes using VTK.</aside></div></section><section><nav class=toc><h2>Table of Contents</h2><ul><li><a href=#section-0>Introduction</a></li><li><a href=#section-1>Solution to run conversion code automatically</a></li><li><a href=#section-2>Dependencies</a></li><li><a href=#section-3>Volume conversion using vtkFlyingEdges3D</a></li><li><a href=#section-4>Smoothing</a></li><li><a href=#section-5>Decimate geometry</a></li><li><a href=#section-6>Write STL file</a></li></ul></nav><div class=qr-code-slides><div id=qr-slides class=qr-code></div><script>jQuery("#qr-slides").qrcode({text:"https://ida-mdc.github.io/workshop-visualization/tutorial-mesh-conversion/"})</script><span>Slides available at <a href=https://ida-mdc.github.io/workshop-visualization/tutorial-mesh-conversion/>https://ida-mdc.github.io/workshop-visualization/tutorial-mesh-conversion/</a></span></div></section><section id=section-0><h2 id=introduction>Introduction</h2><aside class=notes>In this tutorial, we will use <strong>VTK</strong> to convert 3D volumetric datasets (e.g., labelmaps, masks, and raw data) into 3D meshes. This process is particularly useful for creating surfaces that can be used in 3D visualizations, simulations, or exported to Blender for further processing. You will also learn how to optimize these meshes by decimating and smoothing them.</aside><ul><li><strong>VTK</strong> provides robust tools for generating meshes from volumes, including labelmaps and raw pixel data.</li><li><strong>FlyingEdges3D</strong> is a highly efficient algorithm for generating iso-surfaces from volumetric data.</li><li>VTK supports advanced options for mesh optimization, including <strong>smoothing</strong> and <strong>decimation</strong>.</li></ul><div style=flex:1></div><div class=citations><ul><li><a href=http://en.wikipedia.org/wiki/Special:BookSources/978-1-930934-19-1>Schroeder, Will; Martin, Ken; Lorensen, Bill (2006), The Visualization Toolkit (4th ed.), Kitware, ISBN 978-1-930934-19-1</a>, <a href=https://vtk.org/>https://vtk.org/</a></li></ul></div></section><section id=section-1><h2 id=solution-to-run-conversion-code-automatically>Solution to run conversion code automatically</h2><aside class=notes>This tutorial will guide you through using a Python based solution for volume to mesh conversion. We will look
into the details of the code in the following slides.</aside><div class=solution-in-tutorial><p>To simplify and unify solutions used in our tutorials, we use Album, a tool for capturing and sharing specific software use cases in dedicated virtual environments.<br><br>Click the solution box next to this text and follow the displayed usage instructions to run the solution either from command line or graphical interface.</p><a class=solution-box href="https://album.solutions/guide?catalog_url=https://gitlab.com/album-app/catalogs/image-challenges&catalog_name=image-challenges&group=visualization&name=pixel-volumes-to-meshes-vtk&version=0.2.0"><div class=preview><h3>Conversion of 3D pixel datasets into meshes with VTK</h3><div class=subtitle><code>visualization:pixel-volumes-to-meshes-vtk:0.2.0</code></div><p class=description>This solution uses vtkFlyingEdges3D to generate meshes from pixel volumes, including optional smoothing and decimation of vertices, and can optionally display the result.<br><span>Tags: bioinformatics, neuroscience, data-analysis</span></p></div><div class=solution-cover style=background-image:url(https://gitlab.com/album-app/catalogs/image-challenges/-/raw/visualization-pixel-volumes-to-meshes-vtk-0.2.0/solutions/visualization/pixel-volumes-to-meshes-vtk/cover.jpg)></div><div id=metadata-pixel-volumes-to-meshes-vtk class=solution-metadata><div class=solution-details><div class=close-button onclick='toggleMetadata("pixel-volumes-to-meshes-vtk")'>Close solution</div><h3>Conversion of 3D pixel datasets into meshes with VTK</h3><div class=subtitle><code>visualization:pixel-volumes-to-meshes-vtk:0.2.0</code></div><p class=description>This solution uses vtkFlyingEdges3D to generate meshes from pixel volumes, including optional smoothing and decimation of vertices, and can optionally display the result.<br><span>Tags: bioinformatics, neuroscience, data-analysis</span></p><ul class=info><li><strong>License:</strong> MIT</li><li><strong>Solution creator(s):</strong> Deborah Schmidt</li></ul><div class=usage><strong>Usage:</strong><pre><code class=language-python>album install visualization:pixel-volumes-to-meshes-vtk:0.2.0
album run visualization:pixel-volumes-to-meshes-vtk:0.2.0
    --input # (file): Path to the 3D TIFF file containing region data or to a folder containing 3D masks. [Default: ] [Required: Yes]
    --output # (directory): Path to the place where the calculated meshes should be stored. [Default: ] [Required: Yes]
    --detect_labelmap # (boolean): Process int type images as labelmaps. [Default: 1] [Required: No]
    --contour_value # (float): In case continuous datasets are provided, this value can be set to generate meshes at a specific contour value. Otherwise it will be calculated between min and max of the dataset range. [Default: ] [Required: No]
    --smoothing_iterations # (integer): Smoothing iterations, usually between 10 and 50. More iterations typically lead to smoother results. Set to 0 to skip smoothing. [Default: 5] [Required: No]
    --smoothing_pass_band # (float): Smoothing pass band, determines the amount of smoothing. Lower values result in more smoothing. Usually between 0.0 and 2.0. [Default: 0.5] [Required: No]
    --smoothing_feature_angle # (float): The feature angle is the angle between the normals of adjacent polygons. A smaller feature angle will preserve edges. Value in degrees. [Default: 50.0] [Required: No]
    --decimate_percentage # (float): How much to decimate vertices after mesh generation (0-1, 0 means do not decimate). [Default: 0.5] [Required: No]
    --preserve_topology # (boolean): Preserve topology during mesh decimation. [Default: 0] [Required: No]
    --show_meshes # (boolean): Whether to display the generated mesh plots or not. [Default: 0] [Required: No]
    --colormap # (string): Name of the matplotlib colormap to use for coloring meshes. [Default: viridis] [Required: No]
    --exclude_zero # (boolean): Exclude 0 as a label when processing the volumes. [Default: 1] [Required: No]</code></pre></div><div class=citations><p>Cite the following resources if you use this solution:</p><ul><li><a href=https://vtk.org>Schroeder, Will; Martin, Ken; Lorensen, Bill (2006), The Visualization Toolkit (4th ed.), Kitware, ISBN 978-1-930934-19-1</a></li></ul></div></div></div></a></div></section><section id=section-2><h2 id=dependencies>Dependencies</h2><aside class=notes>This is the full specification of the virtual environment used for this solution, including the VTK dependency.</aside><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-pixel-volumes-to-meshes-vtk-0.2.0/solutions/visualization/pixel-volumes-to-meshes-vtk/solution.py?ref_type=tags#L314-329">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">314</span><span>    dependencies<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;environment_file&#39;</span>: <span style=color:#e6db74>&#34;&#34;&#34;channels:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">315</span><span><span style=color:#e6db74>  - conda-forge
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">316</span><span><span style=color:#e6db74>dependencies:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">317</span><span><span style=color:#e6db74>  - python=3.9
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">318</span><span><span style=color:#e6db74>  - pandas=1.5.3
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">319</span><span><span style=color:#e6db74>  - matplotlib-base=3.7.0
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">320</span><span><span style=color:#e6db74>  - numpy=1.24.2
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">321</span><span><span style=color:#e6db74>  - vtk=9.2.6
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">322</span><span><span style=color:#e6db74>  - numpy-stl=3.0.1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">323</span><span><span style=color:#e6db74>  - opencv=4.8.0
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">324</span><span><span style=color:#e6db74>  - pip
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">325</span><span><span style=color:#e6db74>  - pip:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">326</span><span><span style=color:#e6db74>    - vtkplotlib==2.1.0
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">327</span><span><span style=color:#e6db74>    - imagecodecs
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">328</span><span><span style=color:#e6db74>    - tifffile==2023.9.26
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">329</span><span><span style=color:#e6db74>&#34;&#34;&#34;</span>}</span></span></code></pre></div></div></section><section id=section-3><h2 id=volume-conversion-using-vtkflyingedges3d>Volume conversion using vtkFlyingEdges3D</h2><aside class=notes>We start by converting <strong>TIFF files</strong> into meshes. Labelmaps, which contain multiple labels (e.g., for different tissue types), can be converted into separate meshes for each label. Masks, which are binary, will generate a single mesh along the contour where the dataset values cross a defined threshold.</aside><ul><li>Add zero border around dataset</li><li>Load volumetric image using <code>vtkImageData</code></li><li>Generate meshes using <code>vtkFlyingEdges3D</code> algorithm</li><li>Set threshold between foreground and background via <code>GenerateValues (int numContours, double rangeStart, double rangeEnd)</code></li></ul><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-pixel-volumes-to-meshes-vtk-0.2.0/solutions/visualization/pixel-volumes-to-meshes-vtk/solution.py?ref_type=tags#L72-100">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72</span><span>        <span style=color:#75715e># pad the data to get closed meshes at the border of the image</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73</span><span>        data <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>pad(data, ((<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>), (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>), (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)), <span style=color:#e6db74>&#39;constant&#39;</span>, constant_values<span style=color:#f92672>=</span>(<span style=color:#ae81ff>0</span>,))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75</span><span>        <span style=color:#75715e># numpy array to vtk array to vtkImageData</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77</span><span>        depth, height, width <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>shape
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78</span><span>        imageData <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkImageData()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79</span><span>        imageData<span style=color:#f92672>.</span>SetDimensions(width, height, depth)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80</span><span>        imageData<span style=color:#f92672>.</span>SetSpacing((<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82</span><span>        np_dtype <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>dtype
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83</span><span>        vtk_dtype <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>VTK_UNSIGNED_CHAR
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84</span><span>        <span style=color:#66d9ef>if</span> np_dtype <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;float32&#39;</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85</span><span>            vtk_dtype <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>VTK_FLOAT
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86</span><span>        <span style=color:#66d9ef>elif</span> np_dtype <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;float64&#39;</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87</span><span>            vtk_dtype <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>VTK_DOUBLE
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88</span><span>        <span style=color:#66d9ef>elif</span> np_dtype <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;uint8&#39;</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89</span><span>            vtk_dtype <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>VTK_UNSIGNED_CHAR
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91</span><span>        vtk_array <span style=color:#f92672>=</span> numpy_support<span style=color:#f92672>.</span>numpy_to_vtk(num_array<span style=color:#f92672>=</span>data<span style=color:#f92672>.</span>ravel(order<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;C&#39;</span>), deep<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, array_type<span style=color:#f92672>=</span>vtk_dtype)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92</span><span>        imageData<span style=color:#f92672>.</span>GetPointData()<span style=color:#f92672>.</span>SetScalars(vtk_array)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94</span><span>        <span style=color:#75715e># apply flying threshold algorithm to generate mesh from volume</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95</span><span>        discrete <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkFlyingEdges3D()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96</span><span>        discrete<span style=color:#f92672>.</span>SetInputData(imageData)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97</span><span>        discrete<span style=color:#f92672>.</span>SetValue(<span style=color:#ae81ff>1</span>, contour)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98</span><span>        discrete<span style=color:#f92672>.</span>Update()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100</span><span>        next_input <span style=color:#f92672>=</span> discrete<span style=color:#f92672>.</span>GetOutput()</span></span></code></pre></div></div><div style=flex:1></div><div class=citations><ul><li><a href=https://vtk.org/doc/nightly/html/classvtkFlyingEdges3D.html#details>VTK Documentation: vtkFlyingEdges3D</a></li></ul></div></section><section id=section-4><h2 id=smoothing>Smoothing</h2><aside class=notes>In some cases, the original mesh might be too complex or too detailed for efficient rendering or further processing.
Smoothing makes the surface appear less jagged.</aside><ul><li><strong>Number of iterations</strong>: Controls how many smoothing passes are applied.</li><li><strong>Feature Edge Smoothing</strong>: Ensures that important edges are preserved while smoothing.</li><li><strong>Boundary Smoothing</strong>: Smooths out the mesh along the boundaries.</li></ul><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-pixel-volumes-to-meshes-vtk-0.2.0/solutions/visualization/pixel-volumes-to-meshes-vtk/solution.py?ref_type=tags#L103-114">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103</span><span>            <span style=color:#75715e># apply smoothing</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104</span><span>            smoother <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkWindowedSincPolyDataFilter()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105</span><span>            smoother<span style=color:#f92672>.</span>SetInputData(next_input)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106</span><span>            smoother<span style=color:#f92672>.</span>SetNumberOfIterations(smoothing_iterations)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107</span><span>            smoother<span style=color:#f92672>.</span>BoundarySmoothingOn()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108</span><span>            smoother<span style=color:#f92672>.</span>FeatureEdgeSmoothingOn()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109</span><span>            smoother<span style=color:#f92672>.</span>SetFeatureAngle(smoothing_feature_angle)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110</span><span>            smoother<span style=color:#f92672>.</span>SetPassBand(smoothing_pass_band)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111</span><span>            smoother<span style=color:#f92672>.</span>NonManifoldSmoothingOn()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112</span><span>            smoother<span style=color:#f92672>.</span>NormalizeCoordinatesOn()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113</span><span>            smoother<span style=color:#f92672>.</span>Update()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114</span><span>            next_input <span style=color:#f92672>=</span> smoother<span style=color:#f92672>.</span>GetOutput()</span></span></code></pre></div></div><figure><img src=https://ida-mdc.github.io/workshop-visualization/img/vtk-smoothing.png></figure><div style=flex:1></div><div class=citations><ul><li><a href=https://vtk.org/doc/nightly/html/classvtkWindowedSincPolyDataFilter.html#details>VTK Documentation: vtkWindowedSincPolyDataFilter</a></li></ul></div></section><section id=section-5><h2 id=decimate-geometry>Decimate geometry</h2><aside class=notes>In some cases, the original mesh might be too complex or too detailed for efficient rendering or further processing.
Here, we will optimize the meshes by <strong>decimating</strong> them. Decimation reduces the number of polygons in the mesh.</aside><ul><li><strong>Target Reduction</strong>: Defines the percentage reduction in the number of polygons (e.g., 0.5 for 50% reduction).</li><li><strong>Preserve Topology</strong>: Ensures that the overall shape and connectivity of the mesh are maintained during decimation.</li></ul><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-pixel-volumes-to-meshes-vtk-0.2.0/solutions/visualization/pixel-volumes-to-meshes-vtk/solution.py?ref_type=tags#L117-125">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117</span><span>            <span style=color:#75715e># apply decimation of geometry</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118</span><span>            decimate <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkDecimatePro()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119</span><span>            decimate<span style=color:#f92672>.</span>SetInputData(next_input)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120</span><span>            decimate<span style=color:#f92672>.</span>SetTargetReduction(decimate_percentage)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121</span><span>            <span style=color:#66d9ef>if</span> preserve_topology:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122</span><span>                decimate<span style=color:#f92672>.</span>PreserveTopologyOn()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123</span><span>            decimate<span style=color:#f92672>.</span>Update()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125</span><span>            next_input <span style=color:#f92672>=</span> decimate<span style=color:#f92672>.</span>GetOutput()</span></span></code></pre></div></div><figure><img src=https://ida-mdc.github.io/workshop-visualization/img/vtk-mesh-reduction.png></figure><div style=flex:1></div><div class=citations><ul><li><a href=https://vtk.org/doc/nightly/html/classvtkDecimatePro.html#details>VTK Documentation: vtkDecimatePro</a></li></ul></div></section><section id=section-6><h2 id=write-stl-file>Write STL file</h2><p>The final step in this process is to write the generated mesh to an STL file. STL files are widely used for 3D printing, simulations, and visualizations in tools like Blender.</p><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-pixel-volumes-to-meshes-vtk-0.2.0/solutions/visualization/pixel-volumes-to-meshes-vtk/solution.py?ref_type=tags#L155-160">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155</span><span>        <span style=color:#75715e># write binary STL file</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156</span><span>        writer <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkSTLWriter()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157</span><span>        writer<span style=color:#f92672>.</span>SetFileName(path)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158</span><span>        writer<span style=color:#f92672>.</span>SetInputData(next_input)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">159</span><span>        writer<span style=color:#f92672>.</span>SetFileTypeToBinary()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">160</span><span>        writer<span style=color:#f92672>.</span>Write()</span></span></code></pre></div></div></section></div><div class=reveal-footer><span>2024</span> | <span><b>HELMHOLTZ IMAGING</b></span><span><span><a class=hidden-in-page href="?view=scroll"><strong>Exit slides</strong></a></span></span></div></div></main><footer></footer></body></html>