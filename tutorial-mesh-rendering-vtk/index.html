<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Rendering meshes in VTK | 3D Data Visualization Workshop</title><link type=text/css rel=stylesheet href=/workshop-visualization/css/theme.css><link rel=stylesheet href=/workshop-visualization/reveal/plugin/highlight/monokai.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Urbanist:wght@300;400;500;700&display=swap"><script src=/workshop-visualization/js/main.f2979a93a325fecf9605263bd141398a311c8e23388ed7dcff74f92f7e632866.js integrity="sha256-8peak6Ml/s+WBSY70UE5ijEcjiM4jtfc/3T5L35jKGY=" crossorigin=anonymous></script>
<script>function toggleMetadata(e){const t=document.getElementById("metadata-"+e),n=event.target;t.style.display==="none"||t.style.display===""?t.style.display="flex":t.style.display="none"}</script><script>document.addEventListener("DOMContentLoaded",function(){const t=new URLSearchParams(window.location.search),n=t.get("view"),e=document.getElementById("page-content");if(n==="slides"){e.classList.add("reveal"),e.classList.remove("scroll");const n=e=>{const t=document.createElement("link");t.rel="stylesheet",t.href=e,document.head.appendChild(t)},t=(e,t)=>{const n=document.createElement("script");n.src=e,n.onload=t||function(){},document.body.appendChild(n)};n("/workshop-visualization/reveal/dist/reveal.css"),n("/workshop-visualization/reveal/dist/theme/white-hi.css"),n("/workshop-visualization/reveal/plugin/highlight/monokai.css"),t("/workshop-visualization/reveal/dist/reveal.js",function(){console.log("Reveal.js loaded"),t("/workshop-visualization/reveal/plugin/markdown/markdown.js",function(){t("/workshop-visualization/reveal/plugin/highlight/highlight.js",function(){t("/workshop-visualization/reveal/plugin/notes/notes.js",function(){console.log("All Reveal.js plugins loaded and ready to initialize."),typeof Reveal!="undefined"?Reveal.initialize({hash:!0,slideNumber:!0,center:!1,disableLayout:!0,transition:"fade",display:"flex",plugins:[RevealMarkdown,RevealNotes]}):console.error("Reveal.js is not defined, initialization failed.")})})})})}else e.classList.remove("reveal"),e.classList.add("scroll")})</script><script src=/workshop-visualization/js/jquery.min.js></script>
<script type=text/javascript src=/workshop-visualization/js/jquery.qrcode.js></script>
<script type=text/javascript src=/workshop-visualization/js/qrcode.js></script></head><body><header></header><main><div class=workshop id=page-content><div class=reveal-header><a href="?view=slides" class="toggle-view hidden-in-slides">View as Slides</a><div class=hi-icon></div></div><div class="slides limited-width" id=slides-container><section style=background-image:url(/workshop-visualization/img/vtk-meshes.png)><div class=presentation-title><h1>Rendering meshes in VTK</h1><div class=presenter><div>Deborah Schmidt</div><div>Helmholtz Imaging | MDC Berlin</div><div>Sep 25, 2024</div></div><img class=hidden-in-page src=/workshop-visualization/img/RZ_211119_Helmholtz-Imaging_Logo_4C_White.png height=90vh><aside class=notes>Learn how to render 3D meshes in VTK and get insights into the Python code behind it.</aside></div></section><section><nav class=toc><h2>Table of Contents</h2><ul><li><a href=#section-0>Introduction</a></li><li><a href=#section-1>Solution to run VTK code</a></li><li><a href=#section-2>Dependencies</a></li><li><a href=#section-3>Setting the scene</a></li><li><a href=#section-4>Loading and Adding Meshes</a></li><li><a href=#section-5>Loading and Adding Voxel Volumes</a></li><li><a href=#section-8>Creating the Render Window</a></li><li><a href=#section-9>Result</a></li></ul></nav><div class=qr-code-slides><div id=qr-slides class=qr-code></div><script>jQuery("#qr-slides").qrcode({text:"https://ida-mdc.github.io/workshop-visualization/tutorial-mesh-rendering-vtk/"})</script><span>Slides available at <a href=https://ida-mdc.github.io/workshop-visualization/tutorial-mesh-rendering-vtk/>https://ida-mdc.github.io/workshop-visualization/tutorial-mesh-rendering-vtk/</a></span></div></section><section id=section-0><h2 id=introduction>Introduction</h2><aside class=notes><strong>VTK</strong> is a powerful toolkit for rendering 3D meshes, and this tutorial focuses on using the provided solution for rendering scientific 3D datasets. We will explore not just how to run the solution, but also how the underlying Python code works, step by step. You will learn the foundational concepts of VTK while also understanding how to extend the code for your own datasets.</aside><div class=flex></div><div class=horizontal><ul><li>Python based 3D visualization tool</li><li>Supports various formats (STL, OBJ, PLY, ..)</li><li>Advanced rendering capabilities (volume rendering, surface rendering, light and material configuration)</li><li>Supports programmatic animations</li></ul><figure><img src=https://ida-mdc.github.io/workshop-visualization/img/vtk-rendering-slicing.png></figure></div><div class=flex></div><div style=flex:1></div><div class=citations><ul><li><a href=http://en.wikipedia.org/wiki/Special:BookSources/978-1-930934-19-1>Schroeder, Will; Martin, Ken; Lorensen, Bill (2006), The Visualization Toolkit (4th ed.), Kitware, ISBN 978-1-930934-19-1</a>, <a href=https://vtk.org/>https://vtk.org/</a></li></ul></div></section><section id=section-1><h2 id=solution-to-run-vtk-code>Solution to run VTK code</h2><aside class=notes>This tutorial will guide you through using Album&rsquo;s <strong>visualize-meshes-vtk</strong> solution, showcasing how you can interact with 3D meshes and volume data using VTK, all while running it in an isolated environment.</aside><div class=solution-in-tutorial><p>To simplify and unify solutions used in our tutorials, we use Album, a tool for capturing and sharing specific software use cases in dedicated virtual environments.<br><br>Click the solution box next to this text and follow the displayed usage instructions to run the solution either from command line or graphical interface.</p><a class=solution-box href="https://album.solutions/guide?catalog_url=https://gitlab.com/album-app/catalogs/image-challenges&catalog_name=image-challenges&group=visualization&name=visualize-meshes-vtk&version=0.1.0"><div class=preview><h3>Visualize meshes in VTK</h3><div class=subtitle><code>visualization:visualize-meshes-vtk:0.1.0</code></div><p class=description>Displays meshes and optionally renders them to video.<br></p></div><div class=solution-cover style=background-image:url(https://gitlab.com/album-app/catalogs/image-challenges/-/raw/visualization-visualize-meshes-vtk-0.1.0/solutions/visualization/visualize-meshes-vtk/cover.jpg)></div><div id=metadata-visualize-meshes-vtk class=solution-metadata><div class=solution-details><div class=close-button onclick='toggleMetadata("visualize-meshes-vtk")'>Close solution</div><h3>Visualize meshes in VTK</h3><div class=subtitle><code>visualization:visualize-meshes-vtk:0.1.0</code></div><p class=description>Displays meshes and optionally renders them to video.<br></p><ul class=info><li><strong>License:</strong> MIT</li><li><strong>Solution creator(s):</strong> Deborah Schmidt</li></ul><div class=usage><strong>Usage:</strong><pre><code class=language-python>album install visualization:visualize-meshes-vtk:0.1.0
album run visualization:visualize-meshes-vtk:0.1.0
    --meshes # (directory): Path to the meshes. [Default: ] [Required: Yes]
    --volume # (file): Optional volume to render next to the meshes. [Default: ] [Required: No]
    --include # (string): List of names of elements which should be loaded, comma separated [Default: ] [Required: No]
    --exclude # (string): List of names of elements which should not be loaded, comma separated [Default: ] [Required: No]
    --colormap # (string): Name of the matplotlib colormap to use for coloring meshes. [Default: viridis] [Required: No]
    --output_mp4 # (file): If provided, the result is not visualized in a window, but rendered to this path. [Default: ] [Required: No]
    --size # (string): Size of the video in WxH (i.e. &#34;800x600&#34;) [Default: 1600x900] [Required: No]
    --exclude_zero # (boolean): Exclude 0 as a label when processing the volumes. [Default: 1] [Required: No]</code></pre></div><div class=citations><p>Cite the following resources if you use this solution:</p><ul><li><a href=https://vtk.org>Schroeder, Will; Martin, Ken; Lorensen, Bill (2006), The Visualization Toolkit (4th ed.), Kitware, ISBN 978-1-930934-19-1</a></li></ul></div></div></div></a></div></section><section id=section-2><h2 id=dependencies>Dependencies</h2><aside class=notes>This is the full specification of the virtual environment used for this solution, including the VTK dependency.</aside><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-visualize-meshes-vtk-0.1.0/solutions/visualization/visualize-meshes-vtk/solution.py?ref_type=tags#L316-332">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">316</span><span>    dependencies<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;environment_file&#39;</span>: <span style=color:#e6db74>&#34;&#34;&#34;channels:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">317</span><span><span style=color:#e6db74>  - conda-forge
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">318</span><span><span style=color:#e6db74>  - defaults
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">319</span><span><span style=color:#e6db74>dependencies:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">320</span><span><span style=color:#e6db74>  - python=3.9
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">321</span><span><span style=color:#e6db74>  - pandas=1.5.3
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">322</span><span><span style=color:#e6db74>  - matplotlib-base=3.7.0
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">323</span><span><span style=color:#e6db74>  - numpy=1.24.2
</span></span></span><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">324</span><span><span style=color:#e6db74>  - vtk=9.2.6
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">325</span><span><span style=color:#e6db74>  - numpy-stl=3.0.1
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">326</span><span><span style=color:#e6db74>  - opencv=4.8.0
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">327</span><span><span style=color:#e6db74>  - pip
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">328</span><span><span style=color:#e6db74>  - pip:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">329</span><span><span style=color:#e6db74>    - vtkplotlib==2.1.0
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">330</span><span><span style=color:#e6db74>    - imagecodecs
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">331</span><span><span style=color:#e6db74>    - tifffile==2023.9.26
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">332</span><span><span style=color:#e6db74>&#34;&#34;&#34;</span>}</span></span></code></pre></div></div></section><section id=section-3><h2 id=setting-the-scene>Setting the scene</h2><aside class=notes>Let&rsquo;s dive into the code. The <strong>renderer</strong> in VTK is responsible for managing the objects and actors in the scene
and handling how the data will be visualized. The renderer adds objects to the scene, processes lighting, and manages the camera view, ultimately controlling what appears in the rendered image.</aside><ul><li><strong>The renderer</strong>: Manages the <strong>3D scene</strong> by adding objects (called actors), processing lighting, and handling the camera to control how the scene is displayed.</li><li><strong>Central component in VTK</strong>: The renderer is responsible for <strong>compositing all elements</strong> (meshes, volumes, etc.) and rendering them into a final image or interactive display.</li></ul><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-visualize-meshes-vtk-0.1.0/solutions/visualization/visualize-meshes-vtk/solution.py?ref_type=tags#L97-97">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">97</span><span>    renderer <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkRenderer()</span></span></code></pre></div></div></section><section id=section-4><h2 id=loading-and-adding-meshes>Loading and Adding Meshes</h2><aside class=notes>Next, let&rsquo;s look at the Python code responsible for <strong>loading STL meshes</strong>. The solution reads multiple mesh files
from a specified folder and adds them as actors to the scene.</aside><ul><li><strong>Load STL files</strong> via <code>vtkSTLReader</code></li><li><strong>Coloring Meshes</strong> via <code>actor.GetProperty().SetColor()</code></li></ul><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-visualize-meshes-vtk-0.1.0/solutions/visualization/visualize-meshes-vtk/solution.py?ref_type=tags#L119-132">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119</span><span>        reader <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkSTLReader()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120</span><span>        reader<span style=color:#f92672>.</span>SetFileName(vtk_file)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121</span><span>        reader<span style=color:#f92672>.</span>Update()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122</span><span>        <span style=color:#75715e># Create mapper and actor</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123</span><span>        mapper <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkPolyDataMapper()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124</span><span>        mapper<span style=color:#f92672>.</span>SetInputConnection(reader<span style=color:#f92672>.</span>GetOutputPort())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126</span><span>        actor <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkActor()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127</span><span>        actor<span style=color:#f92672>.</span>SetMapper(mapper)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129</span><span>        color_rgba <span style=color:#f92672>=</span> cmap(norm(i))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130</span><span>        actor<span style=color:#f92672>.</span>GetProperty()<span style=color:#f92672>.</span>SetColor(color_rgba[:<span style=color:#ae81ff>3</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132</span><span>        renderer<span style=color:#f92672>.</span>AddActor(actor)</span></span></code></pre></div></div></section><section id=section-5><h2 id=loading-and-adding-voxel-volumes>Loading and Adding Voxel Volumes</h2><h3 id=numpy-to-vtk-conversion>Numpy to VTK Conversion</h3><aside class=notes>In this section, we convert volumetric data (such as TIFF files) into a format that VTK can render. This is done by transforming <strong>NumPy arrays</strong> into VTK-compatible data structures.</aside><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-visualize-meshes-vtk-0.1.0/solutions/visualization/visualize-meshes-vtk/solution.py?ref_type=tags#L45-61">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span>    <span style=color:#f92672>from</span> tifffile <span style=color:#f92672>import</span> imread
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>    <span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span>    <span style=color:#f92672>import</span> vtk
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>    <span style=color:#f92672>from</span> vtk.util <span style=color:#f92672>import</span> numpy_support
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>    tiff_data <span style=color:#f92672>=</span> imread(volume)<span style=color:#f92672>.</span>astype(np<span style=color:#f92672>.</span>uint16)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span>    <span style=color:#75715e># Calculating min and max values from tiff_data</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>    min_val <span style=color:#f92672>=</span> tiff_data<span style=color:#f92672>.</span>min()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>    max_val <span style=color:#f92672>=</span> tiff_data<span style=color:#f92672>.</span>max()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span>    imageData <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkImageData()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span>    imageData<span style=color:#f92672>.</span>SetDimensions(tiff_data<span style=color:#f92672>.</span>shape)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span>    imageData<span style=color:#f92672>.</span>SetSpacing((<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>    <span style=color:#75715e># Efficiently converting the whole numpy array to VTK array</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span>    vtk_array <span style=color:#f92672>=</span> numpy_support<span style=color:#f92672>.</span>numpy_to_vtk(num_array<span style=color:#f92672>=</span>tiff_data<span style=color:#f92672>.</span>ravel(), deep<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, array_type<span style=color:#f92672>=</span>vtk<span style=color:#f92672>.</span>VTK_UNSIGNED_CHAR)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span>    imageData<span style=color:#f92672>.</span>GetPointData()<span style=color:#f92672>.</span>SetScalars(vtk_array)</span></span></code></pre></div></div></section><section id=section-6 class=repeated-heading><h2 id=loading-and-adding-voxel-volumes-1>Loading and Adding Voxel Volumes</h2><h3 id=color-and-opacity-transfer-functions>Color and Opacity Transfer Functions</h3><aside class=notes>This section handles the application of <strong>color and opacity</strong> transfer functions, which define how the volume is rendered based on the underlying voxel values. These functions control how data values are mapped to specific colors and levels of transparency.</aside><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-visualize-meshes-vtk-0.1.0/solutions/visualization/visualize-meshes-vtk/solution.py?ref_type=tags#L63-74">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span><span>    <span style=color:#75715e># Setting up color and opacity transfer functions</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span><span>    colorTransferFunction <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkColorTransferFunction()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span><span>    colorTransferFunction<span style=color:#f92672>.</span>AddRGBPoint(min_val, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>)  <span style=color:#75715e># Mapping min_val to black</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span>    colorTransferFunction<span style=color:#f92672>.</span>AddRGBPoint(max_val, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)  <span style=color:#75715e># Mapping max_val to white</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span><span>    opacityTransferFunction <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkPiecewiseFunction()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span><span>    opacityTransferFunction<span style=color:#f92672>.</span>AddPoint(min_val, <span style=color:#ae81ff>0.0</span>)  <span style=color:#75715e># Fully transparent at min_val</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span><span>    opacityTransferFunction<span style=color:#f92672>.</span>AddPoint(max_val, <span style=color:#ae81ff>0.5</span>)  <span style=color:#75715e># Semi-transparent at max_val</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span><span>    volumeProperty <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkVolumeProperty()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span><span>    volumeProperty<span style=color:#f92672>.</span>SetColor(colorTransferFunction)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span><span>    volumeProperty<span style=color:#f92672>.</span>SetScalarOpacity(opacityTransferFunction)</span></span></code></pre></div></div></section><section id=section-7 class=repeated-heading><h2 id=loading-and-adding-voxel-volumes-2>Loading and Adding Voxel Volumes</h2><h3 id=creating-a-volume-node>Creating a Volume Node</h3><aside class=notes>Once the volumetric data has been prepared and the transfer functions defined, a <strong>volume node</strong> is created to represent the volumetric data in the 3D scene. This is what gets rendered by VTK&rsquo;s pipeline.</aside><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-visualize-meshes-vtk-0.1.0/solutions/visualization/visualize-meshes-vtk/solution.py?ref_type=tags#L76-80">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76</span><span>    volume <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkVolume()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77</span><span>    volumeMapper <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkSmartVolumeMapper()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78</span><span>    volumeMapper<span style=color:#f92672>.</span>SetInputData(imageData)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79</span><span>    volume<span style=color:#f92672>.</span>SetProperty(volumeProperty)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">80</span><span>    volume<span style=color:#f92672>.</span>SetMapper(volumeMapper)</span></span></code></pre></div></div></section><section id=section-8><h2 id=creating-the-render-window>Creating the Render Window</h2><aside class=notes>The <strong>render window</strong> is where the final rendering of the meshes and volumes occurs. It controls how the scene is displayed, and can output either to the screen for interactive visualization or to a video file for post-processing.</aside><ul><li><strong>Render Window</strong>: Manages the actual window where the scene is displayed.</li><li><strong>RenderWindowInteractor</strong>: Allows for interactive control of the 3D scene using mouse and keyboard inputs.</li></ul><div class=solution-code-link><p class=solution-source-code><a href="https://gitlab.com/album-app/catalogs/image-challenges/-/blob/visualization-visualize-meshes-vtk-0.1.0/solutions/visualization/visualize-meshes-vtk/solution.py?ref_type=tags#L33-41">Link to full source code</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-py data-lang=py><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>    renderWindow <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkRenderWindow()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>    renderWindow<span style=color:#f92672>.</span>AddRenderer(renderer)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>    <span style=color:#66d9ef>if</span> output_mp4:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>        render_video(output_mp4, rendering_size, renderWindow, renderer)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>        render_window_interactor <span style=color:#f92672>=</span> vtk<span style=color:#f92672>.</span>vtkRenderWindowInteractor()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>        render_window_interactor<span style=color:#f92672>.</span>SetRenderWindow(renderWindow)
</span></span><span style=display:flex;background-color:#3c3d38><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>        render_window_interactor<span style=color:#f92672>.</span>Start()</span></span></code></pre></div></div></section><section id=section-9><h2 id=result>Result</h2><aside class=notes>In this tutorial, we explored how to render 3D meshes and voxel volumes in VTK, step by step. VTK offers a wide range of features for visualizing scientific data in 3D, from applying advanced material properties to handling complex volumetric datasets. As you continue working with VTK, explore its many additional features, including streamlines for flow visualization, annotations, and 3D text labels for enhancing your visualizations.</aside><div class=center><figure><img src=https://ida-mdc.github.io/workshop-visualization/img/vtk-mesh-volume.png alt="Meshes and volume in one view." width=800px><figcaption><p>Meshes and volume in one view.</p></figcaption></figure></div><div style=flex:1></div><div class=citations><ul><li><a href=https://vtk.org/documentation/>VTK Documentation</a></li><li><a href=https://examples.vtk.org/site/Python>VTK Python Examples and Tutorials</a></li><li><a href=https://album.solutions>Album Framework</a></li></ul></div></section></div><div class=reveal-footer><span>2024</span> | <span><b>HELMHOLTZ IMAGING</b></span><span><span><a class=hidden-in-page href="?view=scroll"><strong>Exit slides</strong></a></span></span></div></div></main><footer></footer></body></html>